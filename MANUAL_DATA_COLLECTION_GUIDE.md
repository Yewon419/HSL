# í•œêµ­ ì£¼ì‹ ê±°ë˜ ë°ì´í„° ìˆ˜ë™ ìˆ˜ì§‘ ë§¤ë‰´ì–¼

> **ì‘ì„±ì¼**: 2025-10-22
> **ìµœì¢… ê²€ì¦**: 2025-10-22 (ì£¼ê°€ 2,761ê°œ, ì§€í‘œ 2,775ê°œ ì™„ì „ ìˆ˜ì§‘)
> **ìš©ë„**: ì‹œìŠ¤í…œ ë‹¤ìš´íƒ€ì„, ë°ì´í„° ëˆ„ë½ ì‹œ ìˆ˜ë™ ë³µêµ¬

---

## ğŸ“‹ ëª©ì°¨

1. [ì‚¬ì „ í™•ì¸ ì²´í¬ë¦¬ìŠ¤íŠ¸](#1-ì‚¬ì „-í™•ì¸-ì²´í¬ë¦¬ìŠ¤íŠ¸)
2. [ë°ì´í„°ë² ì´ìŠ¤ í˜„í™© í™•ì¸](#2-ë°ì´í„°ë² ì´ìŠ¤-í˜„í™©-í™•ì¸)
3. [ìˆ˜ì§‘ í”„ë¡œê·¸ë¨ ì¤€ë¹„](#3-ìˆ˜ì§‘-í”„ë¡œê·¸ë¨-ì¤€ë¹„)
4. [ìˆ˜ì§‘ í”„ë¡œì„¸ìŠ¤](#4-ìˆ˜ì§‘-í”„ë¡œì„¸ìŠ¤)
5. [ê²€ì¦ ë° ì™„ë£Œ](#5-ê²€ì¦-ë°-ì™„ë£Œ)
6. [ë¬¸ì œ í•´ê²°](#6-ë¬¸ì œ-í•´ê²°)

---

## 1. ì‚¬ì „ í™•ì¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 1.1 í˜„ì¬ ë‚ ì§œ ë° ì‹œê°„ í™•ì¸

**âš ï¸ ì¤‘ìš”**: ClaudeëŠ” ì ˆëŒ€ë¡œ ë‚ ì§œë¥¼ ì¶”ë¡ í•´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤. ì‹œìŠ¤í…œ ëª…ë ¹ì–´ë¡œ í™•ì¸í•˜ì„¸ìš”.

```bash
# Windows PowerShell
powershell -Command "Get-Date -Format 'yyyy-MM-dd dddd HH:mm:ss'"

# ì˜ˆìƒ ì¶œë ¥:
# 2025-10-22 ìˆ˜ìš”ì¼ 20:31:45
```

**í™•ì¸í•  ì •ë³´**:
- âœ… í˜„ì¬ ë‚ ì§œ: `__________`
- âœ… í˜„ì¬ ìš”ì¼: `__________` (ì›”/í™”/ìˆ˜/ëª©/ê¸ˆ/í† /ì¼)
- âœ… í˜„ì¬ ì‹œê°„: `__________` (HH:mm:ss)
- âœ… ì‹œê°„ëŒ€: í•œêµ­ ì‹œê°„ (KST, UTC+9)

### 1.2 í•œêµ­ ì£¼ì‹ ì‹œì¥ ìš´ì˜ ìƒíƒœ í™•ì¸

#### í‰ì¼/ì£¼ë§ êµ¬ë¶„

| ìš”ì¼ | ì¥ ìƒíƒœ | ìˆ˜ì§‘ í•„ìš” |
|------|--------|---------|
| ì›”~ê¸ˆ | ê°œì¥ | âœ… í•„ìš” |
| í†  | íœ´ì¥ | âŒ ë¶ˆí•„ìš” |
| ì¼ | íœ´ì¥ | âŒ ë¶ˆí•„ìš” |

**í˜„ì¬ ìš”ì¼**: `__________` â†’ ì¥ ìƒíƒœ: `__________`

#### ê³µíœ´ì¼ í™•ì¸

```
2025ë…„ í•œêµ­ ì£¼ì‹ì‹œì¥ ê³µíœ´ì¼:
- 01-01: ì‹ ì •
- 02-10~12: ì„¤ ì—°íœ´
- 03-01: ì‚¼ì¼ì ˆ
- 04-10: êµ­íšŒì˜ì› ì„ ê±°ì¼
- 05-05: ì–´ë¦°ì´ë‚ 
- 05-15: ë¶€ì²˜ë‹˜ ì˜¤ì‹  ë‚ 
- 06-06: í˜„ì¶©ì¼
- 08-15: ê´‘ë³µì ˆ
- 09-16~18: ì¶”ì„ ì—°íœ´
- 10-03: ê°œì²œì ˆ
- 10-09: í•œê¸€ë‚ 
- 12-25: í¬ë¦¬ìŠ¤ë§ˆìŠ¤
```

**í˜„ì¬ ë‚ ì§œê°€ ê³µíœ´ì¼ì¸ê°€?**: â˜ Yes / â˜ No

### 1.3 ì¥ ì¢…ë£Œ ì‹œê°„ í™•ì¸

```
í•œêµ­ ì£¼ì‹ì‹œì¥ ê±°ë˜ ì‹œê°„:
- ê°œì¥ ì‹œê°„: 09:00 KST
- ì¥ ë§ˆê° ì‹œê°„: 15:30 KST (ì˜¤í›„ 3ì‹œ 30ë¶„)
- ë°ì´í„° ìˆ˜ì§‘ ê¶Œì¥ ì‹œê°„: 15:30 ì´í›„ (ì¥ ë§ˆê° í›„)
```

**í˜„ì¬ ì‹œê°„ì´ 15:30 ì´í›„ì¸ê°€?**: â˜ Yes / â˜ No

### 1.4 ì‚¬ì „ í™•ì¸ ê²°ê³¼

```
âœ… í‰ì¼ && 15:30 ì´í›„ â†’ ì§„í–‰í•˜ê¸°
âŒ ì£¼ë§ ë˜ëŠ” ê³µíœ´ì¼ â†’ ìˆ˜ì§‘ ì¤‘ë‹¨
âŒ 15:30 ì´ì „ â†’ ì‹œê°„ ëŒ€ê¸°
```

**ìˆ˜ì§‘ ì§„í–‰ ì—¬ë¶€**: â˜ ì§„í–‰ / â˜ ì¤‘ë‹¨

---

## 2. ë°ì´í„°ë² ì´ìŠ¤ í˜„í™© í™•ì¸

### 2.1 Docker ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸

```bash
cd stock-trading-system
docker-compose ps
```

**í•„ìˆ˜ ì»¨í…Œì´ë„ˆ** (ëª¨ë‘ `Up` ìƒíƒœì—¬ì•¼ í•¨):
- â˜ stock-db (PostgreSQL/TimescaleDB)
- â˜ stock-backend (FastAPI)
- â˜ stock-redis
- â˜ stock-airflow-scheduler
- â˜ stock-airflow-webserver

### 2.2 ë°ì´í„°ë² ì´ìŠ¤ ì ‘ì† í™•ì¸

```bash
docker exec stock-db psql -U admin -d stocktrading -c "SELECT version();"
```

**ì˜ˆìƒ ì¶œë ¥**:
```
PostgreSQL 15.x on x86_64-pc-linux-gnu, ...
(1 row)
```

### 2.3 ëŒ€ìƒ ë‚ ì§œì˜ ë°ì´í„° í˜„í™© ì¡°íšŒ

**ë³€ìˆ˜ ì„¤ì •** (ì¤‘ìš”!):
```bash
TARGET_DATE="2025-10-22"  # ìˆ˜ì§‘í•˜ë ¤ëŠ” ë‚ ì§œ (YYYY-MM-DD í˜•ì‹)
```

**í˜„í™© í™•ì¸ ì¿¼ë¦¬**:
```bash
docker exec stock-db psql -U admin -d stocktrading -c "
SELECT
    '$TARGET_DATE' as target_date,
    (SELECT COUNT(*) FROM stock_prices WHERE date = '$TARGET_DATE'::date) as price_count,
    (SELECT COUNT(DISTINCT ticker) FROM stock_prices WHERE date = '$TARGET_DATE'::date) as price_tickers,
    (SELECT COUNT(*) FROM technical_indicators WHERE date = '$TARGET_DATE'::date) as indicator_count,
    (SELECT COUNT(DISTINCT ticker) FROM technical_indicators WHERE date = '$TARGET_DATE'::date) as indicator_tickers,
    (SELECT COUNT(*) FROM market_indices WHERE date = '$TARGET_DATE'::date) as indices_count;
"
```

**ì˜ˆìƒ ì¶œë ¥** (ì™„ì „ ìˆ˜ì§‘ëœ ê²½ìš°):
```
 target_date |  price_count | price_tickers | indicator_count | indicator_tickers | indices_count
-----------+-----------+-----------+-----------+-----------+-----------
 2025-10-22 |      2761 |      2761 |      2775 |      2775 |         2
(1 row)
```

### 2.4 ì–´ì œ ë°ì´í„°ì™€ ë¹„êµ (ëˆ„ë½ í™•ì¸)

```bash
TARGET_DATE="2025-10-22"
YESTERDAY=$(date -d "$TARGET_DATE -1 day" +%Y-%m-%d)

docker exec stock-db psql -U admin -d stocktrading -c "
SELECT
    'Yesterday' as day, COUNT(DISTINCT ticker) as tickers
FROM stock_prices
WHERE date = '$YESTERDAY'::date
UNION ALL
SELECT
    'Today' as day, COUNT(DISTINCT ticker) as tickers
FROM stock_prices
WHERE date = '$TARGET_DATE'::date
ORDER BY day;
"
```

**ê²°ê³¼ í•´ì„**:
- Yesterday = Today â†’ ì™„ë²½ ë™ê¸°í™” âœ…
- Yesterday > Today â†’ **ëˆ„ë½ ë°œìƒ** âš ï¸ (ì•„ë˜ì˜ Step 4 ì‹¤í–‰)

### 2.5 ëˆ„ë½ëœ í‹°ì»¤ ì¡°íšŒ (ë¬¸ì œ ë°œìƒ ì‹œ)

```bash
TARGET_DATE="2025-10-22"
YESTERDAY=$(date -d "$TARGET_DATE -1 day" +%Y-%m-%d)

docker exec stock-db psql -U admin -d stocktrading -c "
SELECT COUNT(*) as missing_tickers
FROM (
    SELECT t1.ticker
    FROM (SELECT DISTINCT ticker FROM stock_prices WHERE date = '$YESTERDAY'::date) t1
    LEFT JOIN (SELECT DISTINCT ticker FROM stock_prices WHERE date = '$TARGET_DATE'::date) t2
    ON t1.ticker = t2.ticker
    WHERE t2.ticker IS NULL
) sub;
"
```

**ê²°ê³¼ ê¸°ë¡**:
- ëˆ„ë½ëœ í‹°ì»¤ ìˆ˜: `__________` ê°œ

---

## 3. ìˆ˜ì§‘ í”„ë¡œê·¸ë¨ ì¤€ë¹„

### 3.1 í•„ìˆ˜ í…Œì´ë¸” êµ¬ì¡° í™•ì¸

#### stock_prices í…Œì´ë¸”

```bash
docker exec stock-db psql -U admin -d stocktrading -c "\d stock_prices"
```

**í•„ìˆ˜ ì»¬ëŸ¼**:
- â˜ ticker (varchar, PK)
- â˜ date (date, PK)
- â˜ open_price (numeric)
- â˜ high_price (numeric)
- â˜ low_price (numeric)
- â˜ close_price (numeric)
- â˜ volume (bigint)
- â˜ created_at (timestamp)

#### technical_indicators í…Œì´ë¸”

```bash
docker exec stock-db psql -U admin -d stocktrading -c "\d technical_indicators"
```

**í•„ìˆ˜ ì»¬ëŸ¼** (ì»¬ëŸ¼ëª… ì •í™•íˆ í™•ì¸):
- â˜ ticker (varchar, PK)
- â˜ date (date, PK)
- â˜ rsi (numeric)
- â˜ macd (numeric)
- â˜ macd_signal (numeric)
- â˜ **ma_20** âš ï¸ (NOT sma_20)
- â˜ **ma_50** âš ï¸ (NOT sma_50)
- â˜ **ma_200** âš ï¸ (NOT sma_200)
- â˜ **bollinger_upper** âš ï¸ (NOT bb_upper)
- â˜ **bollinger_lower** âš ï¸ (NOT bb_lower)
- â˜ created_at (timestamp)

#### market_indices í…Œì´ë¸”

```bash
docker exec stock-db psql -U admin -d stocktrading -c "\d market_indices"
```

**í•„ìˆ˜ ì»¬ëŸ¼**:
- â˜ index_name (varchar, PK)
- â˜ date (date, PK)
- â˜ open_value (numeric)
- â˜ high_value (numeric)
- â˜ low_value (numeric)
- â˜ close_value (numeric)
- â˜ volume (bigint)
- â˜ created_at (timestamp)

### 3.2 Python í™˜ê²½ í™•ì¸

```bash
docker exec stock-backend python -c "import pykrx; print('pykrx version:', pykrx.__version__)"
```

**í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬**:
- â˜ pykrx (í•œêµ­ ì£¼ì‹ ë°ì´í„° API)
- â˜ pandas
- â˜ numpy
- â˜ sqlalchemy
- â˜ psycopg2

### 3.3 Backend ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸

```bash
docker exec stock-backend python -c "from database import SessionLocal; db = SessionLocal(); print('âœ… Database connection OK'); db.close()"
```

**ì˜ˆìƒ ê²°ê³¼**: `âœ… Database connection OK`

---

## 4. ìˆ˜ì§‘ í”„ë¡œì„¸ìŠ¤

### 4.1 Step 1: ì£¼ê°€ ë°ì´í„° ìˆ˜ì§‘

#### í”„ë¡œê·¸ë¨ ë‹¤ìš´ë¡œë“œ ë° ì‹¤í–‰

**ê²½ë¡œ**: `F:\hhstock\collect_stock_data_YYYYMMDD.py`

```bash
# ë³€ìˆ˜ ì„¤ì • (ë§¤ìš° ì¤‘ìš”!)
TARGET_DATE="2025-10-22"

# ìŠ¤í¬ë¦½íŠ¸ ìƒì„± ë° ë³µì‚¬
pwsh -c "
\$date = '$TARGET_DATE'.Replace('-', '')
Copy-Item 'F:\hhstock\collect_stock_data_20251022.py' -Destination "F:\hhstock\collect_stock_data_\${date}.py"
"

# ì»¨í…Œì´ë„ˆë¡œ ë³µì‚¬
docker cp "F:\hhstock\collect_stock_data_YYYYMMDD.py" stock-backend:/app/

# ìˆ˜ì§‘ ì‹¤í–‰
docker exec stock-backend python /app/collect_stock_data_YYYYMMDD.py
```

#### ë³€ìˆ˜ í™•ì¸ (ì¤‘ìš”!)

ìˆ˜ì§‘ ìŠ¤í¬ë¦½íŠ¸ ë‚´ ë‹¤ìŒ ë³€ìˆ˜ê°€ **ì •í™•í•œ ë‚ ì§œ**ë¡œ ì„¤ì •ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤:

```python
TARGET_DATE = date(2025, 10, 22)  # ë…„, ì›”, ì¼ ì •í™•íˆ ì„¤ì •
DATE_STR = TARGET_DATE.strftime('%Y%m%d')  # "20251022"
```

#### ìˆ˜ì§‘ í”„ë¡œì„¸ìŠ¤ ëª¨ë‹ˆí„°ë§

```
ì§„í–‰ ìƒí™© í™•ì¸:
[200/959] ì§„í–‰ ì¤‘... (ì„±ê³µ: 200, ì˜¤ë¥˜: 0)
[400/959] ì§„í–‰ ì¤‘... (ì„±ê³µ: 400, ì˜¤ë¥˜: 0)
...
âœ… ì£¼ê°€ ìˆ˜ì§‘ ì™„ë£Œ: 949 ì¢…ëª© ì €ì¥ë¨
ë°ì´í„°ë² ì´ìŠ¤ í™•ì¸: 959 ê°œì˜ ì£¼ê°€ ë ˆì½”ë“œ
```

**ì„±ê³µ ê¸°ì¤€**:
- âœ… ìµœì†Œ 2,500ê°œ ì´ìƒì˜ ì£¼ê°€ ì €ì¥
- âœ… ì˜¤ë¥˜ìœ¨ < 5%
- âœ… "ì£¼ê°€ ìˆ˜ì§‘ ì™„ë£Œ" ë©”ì‹œì§€ í‘œì‹œ

### 4.2 Step 2: ê¸°ìˆ ì  ì§€í‘œ ê³„ì‚°

#### í”„ë¡œê·¸ë¨ êµ¬ì¡°

**í¬í•¨ëœ í•¨ìˆ˜**:
- `calculate_rsi()` - RSI (14-period)
- `calculate_macd()` - MACD (12, 26, 9)
- `calculate_sma()` - Simple Moving Average (20, 50, 200)
- `calculate_bollinger_bands()` - Bollinger Bands (20-period, 2 std dev)

#### ì‹¤í–‰

```bash
docker exec stock-backend python /app/collect_stock_data_YYYYMMDD.py
```

**í”„ë¡œì„¸ìŠ¤ íë¦„**:
```
1. ì£¼ê°€ ë°ì´í„° ìˆ˜ì§‘ (ìœ„ Step 1ê³¼ ë™ì¼)
2. ê¸°ìˆ ì  ì§€í‘œ ê³„ì‚° ì‹œì‘
   â””â”€ ë¡œë“œëœ ì£¼ê°€ ë°ì´í„°: ~3,070,000 í–‰
   â””â”€ ì²˜ë¦¬í•  í‹°ì»¤: ~2,779 ê°œ
3. ê° í‹°ì»¤ë³„ ì§€í‘œ ê³„ì‚°
   â””â”€ RSI, MACD, SMA 20/50/200, Bollinger Bands
4. ì§€í‘œ DB ì €ì¥
   â””â”€ ma_20, ma_50, ma_200 (ì£¼ì˜: sma_* ì•„ë‹˜!)
   â””â”€ bollinger_upper, bollinger_lower
```

#### ì˜ˆìƒ ì¶œë ¥

```
[200/2779] ì§„í–‰ ì¤‘... (ì²˜ë¦¬: 200)
[400/2779] ì§„í–‰ ì¤‘... (ì²˜ë¦¬: 398)
...
[2600/2779] ì§„í–‰ ì¤‘... (ì²˜ë¦¬: 2597)

[200/2775] ì €ì¥ ì¤‘...
[400/2775] ì €ì¥ ì¤‘...
...

âœ… ê¸°ìˆ ì  ì§€í‘œ ê³„ì‚° ì™„ë£Œ: 2775 ì¢…ëª© ì €ì¥ë¨
```

**ì„±ê³µ ê¸°ì¤€**:
- âœ… ìµœì†Œ 2,500ê°œ ì´ìƒì˜ ì§€í‘œ ì €ì¥
- âœ… "ê¸°ìˆ ì  ì§€í‘œ ê³„ì‚° ì™„ë£Œ" ë©”ì‹œì§€ í‘œì‹œ

### 4.3 Step 3: ì‹œì¥ ì§€ìˆ˜ ìˆ˜ì§‘ (ì„ íƒì‚¬í•­)

**ìƒíƒœ**: í˜„ì¬ pykrx API ì´ìŠˆë¡œ ì¸í•´ ìŠ¤í‚µë¨

```python
# ìˆ˜ì§‘ ì˜ˆì • ì§€ìˆ˜
KOSPI  - í•œêµ­ì¢…í•©ì£¼ê°€ì§€ìˆ˜
KOSDAQ - ì½”ìŠ¤ë‹¥ ì§€ìˆ˜
```

---

## 5. ê²€ì¦ ë° ì™„ë£Œ

### 5.1 ìµœì¢… ë°ì´í„° í™•ì¸

```bash
TARGET_DATE="2025-10-22"

docker exec stock-db psql -U admin -d stocktrading -c "
SELECT
    '$TARGET_DATE' as date,
    (SELECT COUNT(*) FROM stock_prices WHERE date = '$TARGET_DATE'::date) as prices,
    (SELECT COUNT(DISTINCT ticker) FROM stock_prices WHERE date = '$TARGET_DATE'::date) as price_tickers,
    (SELECT COUNT(*) FROM technical_indicators WHERE date = '$TARGET_DATE'::date) as indicators,
    (SELECT COUNT(DISTINCT ticker) FROM technical_indicators WHERE date = '$TARGET_DATE'::date) as indicator_tickers;
"
```

### 5.2 ì–´ì œì™€ì˜ ë™ê¸°í™” ê²€ì¦

```bash
TARGET_DATE="2025-10-22"
YESTERDAY=$(date -d "$TARGET_DATE -1 day" +%Y-%m-%d)

docker exec stock-db psql -U admin -d stocktrading -c "
SELECT
    '$YESTERDAY' as yesterday, COUNT(DISTINCT ticker) as tickers FROM stock_prices WHERE date = '$YESTERDAY'::date
UNION ALL
SELECT
    '$TARGET_DATE' as today, COUNT(DISTINCT ticker) as tickers FROM stock_prices WHERE date = '$TARGET_DATE'::date
ORDER BY 1 DESC;
"
```

**ê²°ê³¼ í•´ì„**:
- ë™ì¼í•œ ìˆ˜ â†’ âœ… ì™„ë²½ ë™ê¸°í™”
- ì–´ì œ > ì˜¤ëŠ˜ â†’ âŒ ëˆ„ë½ ì¡´ì¬ (Step 4 ë°˜ë³µ)

### 5.3 í’ˆì§ˆ ê²€ì¦

#### ê°œë³„ í‹°ì»¤ ìƒ˜í”Œ í™•ì¸

```bash
TARGET_DATE="2025-10-22"

docker exec stock-db psql -U admin -d stocktrading -c "
SELECT
    sp.ticker,
    sp.date,
    sp.close_price,
    ti.rsi,
    ti.ma_20,
    ti.ma_50,
    ti.ma_200,
    ti.bollinger_upper,
    ti.bollinger_lower
FROM stock_prices sp
LEFT JOIN technical_indicators ti ON sp.ticker = ti.ticker AND sp.date = ti.date
WHERE sp.date = '$TARGET_DATE'::date
LIMIT 10;
"
```

**í™•ì¸ í•­ëª©**:
- â˜ close_price ê°’ì´ 0ì´ ì•„ë‹Œê°€?
- â˜ RSIê°€ 0~100 ë²”ìœ„ì¸ê°€?
- â˜ MA ê°’ë“¤ì´ ì •ìƒì¸ê°€?
- â˜ Bollinger ë°´ë“œê°€ ì œëŒ€ë¡œ ê³„ì‚°ë˜ì—ˆëŠ”ê°€?

#### NULL ê°’ í™•ì¸

```bash
TARGET_DATE="2025-10-22"

docker exec stock-db psql -U admin -d stocktrading -c "
SELECT
    COUNT(*) as null_count
FROM technical_indicators
WHERE date = '$TARGET_DATE'::date
AND (rsi IS NULL OR ma_20 IS NULL OR ma_50 IS NULL OR ma_200 IS NULL);
"
```

**ê²°ê³¼**:
- 0 ë˜ëŠ” ë§¤ìš° ì ì€ ìˆ˜ â†’ âœ… ì •ìƒ
- ë§ì€ ìˆ˜ â†’ âš ï¸ ì¶”ê°€ í™•ì¸ í•„ìš”

### 5.4 ìµœì¢… ì²´í¬ë¦¬ìŠ¤íŠ¸

```
âœ… ì£¼ê°€ ë°ì´í„° ì™„ì„±ë„
   â””â”€ ì–´ì œì™€ ë™ì¼í•œ ìˆ˜ì˜ í‹°ì»¤ ìˆ˜ì§‘
   â””â”€ ìµœì†Œ 2,700ê°œ ì´ìƒì˜ ì£¼ê°€ ë°ì´í„°

âœ… ì§€í‘œ ë°ì´í„° ì™„ì„±ë„
   â””â”€ ìµœì†Œ 2,750ê°œ ì´ìƒì˜ ì§€í‘œ ë°ì´í„°
   â””â”€ NULL ê°’ ìµœì†Œí™”

âœ… ë°ì´í„° í’ˆì§ˆ
   â””â”€ ì •ìƒì ì¸ OHLCV ê°’ ë²”ìœ„
   â””â”€ ì •ìƒì ì¸ ì§€í‘œ ê°’ ë²”ìœ„

âœ… ì‹œìŠ¤í…œ ì •ìƒì„±
   â””â”€ ëª¨ë“  Docker ì»¨í…Œì´ë„ˆ ìš´ì˜ ì¤‘
   â””â”€ ë°ì´í„°ë² ì´ìŠ¤ ì ‘ì† ì„±ê³µ
```

---

## 6. ë¬¸ì œ í•´ê²°

### 6.1 ì£¼ê°€ ë°ì´í„° ìˆ˜ì§‘ ì‹¤íŒ¨

#### ì¦ìƒ: "No stock prices fetched"

**ì›ì¸ ë¶„ì„**:
```bash
# 1. ë‚ ì§œ í™•ì¸
date '+%Y-%m-%d'  # ì‹¤ì œ ì˜¤ëŠ˜ ë‚ ì§œ

# 2. ì£¼ë§/ê³µíœ´ì¼ í™•ì¸
# í† ìš”ì¼ ë˜ëŠ” ì¼ìš”ì¼ì´ê±°ë‚˜ ê³µíœ´ì¼ì¸ê°€?

# 3. ì¥ ì‹œê°„ í™•ì¸
date '+%H:%M'  # í˜„ì¬ ì‹œê°„ì´ 15:30 ì´í›„ì¸ê°€?
```

**í•´ê²° ë°©ë²•**:
1. í‰ì¼ 15:30 ì´í›„ì— ë‹¤ì‹œ ì‹œë„
2. ë‚ ì§œê°€ ì •í™•í•˜ê²Œ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸
3. pykrx API ìƒíƒœ í™•ì¸

#### ì¦ìƒ: "Column undefined error"

**ì›ì¸**: ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ì»¬ëŸ¼ëª… ë¶ˆì¼ì¹˜

```python
# âŒ ì˜ëª»ëœ ì»¬ëŸ¼ëª…
'sma_20', 'sma_50', 'sma_200'
'bb_upper', 'bb_lower'

# âœ… ì˜¬ë°”ë¥¸ ì»¬ëŸ¼ëª…
'ma_20', 'ma_50', 'ma_200'
'bollinger_upper', 'bollinger_lower'
```

**í•´ê²° ë°©ë²•**: ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì»¬ëŸ¼ëª… ìˆ˜ì • (ìœ„ì˜ 3.1 ì°¸ê³ )

### 6.2 ì§€í‘œ ê³„ì‚° ì‹¤íŒ¨

#### ì¦ìƒ: "No indicators calculated"

**ì›ì¸ ë¶„ì„**:
```bash
# ì£¼ê°€ ë°ì´í„° í™•ì¸
TARGET_DATE="2025-10-22"
docker exec stock-db psql -U admin -d stocktrading -c "
SELECT COUNT(*) FROM stock_prices WHERE date = '$TARGET_DATE'::date;
"
```

**ê²°ê³¼ê°€ 0ì´ë©´**: Step 1ë¶€í„° ë‹¤ì‹œ ì‹¤í–‰
**ê²°ê³¼ê°€ > 0ì´ë©´**: ì§€í‘œ ê³„ì‚° ë¡œê·¸ í™•ì¸

### 6.3 ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨

#### ì¦ìƒ: "Could not connect to database"

```bash
# 1. ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
docker-compose ps | grep stock-db

# 2. ê°•ì œ ì¬ì‹œì‘
docker-compose restart stock-db
docker-compose restart stock-backend

# 3. ë„¤íŠ¸ì›Œí¬ í™•ì¸
docker network ls
```

### 6.4 ëˆ„ë½ëœ ë°ì´í„° íƒì§€

```bash
TARGET_DATE="2025-10-22"
YESTERDAY=$(date -d "$TARGET_DATE -1 day" +%Y-%m-%d)

# ëˆ„ë½ëœ í‹°ì»¤ ëª©ë¡ (ìƒìœ„ 20ê°œ)
docker exec stock-db psql -U admin -d stocktrading -c "
SELECT t1.ticker
FROM (SELECT DISTINCT ticker FROM stock_prices WHERE date = '$YESTERDAY'::date) t1
LEFT JOIN (SELECT DISTINCT ticker FROM stock_prices WHERE date = '$TARGET_DATE'::date) t2
ON t1.ticker = t2.ticker
WHERE t2.ticker IS NULL
ORDER BY t1.ticker
LIMIT 20;
"

# ëˆ„ë½ëœ í‹°ì»¤ ì´ ê°œìˆ˜
docker exec stock-db psql -U admin -d stocktrading -c "
SELECT COUNT(*) as missing_tickers
FROM (
    SELECT t1.ticker FROM (SELECT DISTINCT ticker FROM stock_prices WHERE date = '$YESTERDAY'::date) t1
    LEFT JOIN (SELECT DISTINCT ticker FROM stock_prices WHERE date = '$TARGET_DATE'::date) t2
    ON t1.ticker = t2.ticker
    WHERE t2.ticker IS NULL
) sub;
"
```

**ëˆ„ë½ì´ ë°œìƒí–ˆë‹¤ë©´**:
1. `collect_missing_tickers_20251022.py` ì‹¤í–‰
2. `calculate_missing_indicators_20251022.py` ì‹¤í–‰

---

## ğŸ“ ìˆ˜ì§‘ ê¸°ë¡ ì–‘ì‹

ê° ìˆ˜ì§‘ ì‹œë§ˆë‹¤ ë‹¤ìŒ ì •ë³´ë¥¼ ê¸°ë¡í•˜ì„¸ìš”:

```
ìˆ˜ì§‘ ì¼ì: ____________________
ìˆ˜ì§‘ ëŒ€ìƒ ë‚ ì§œ: ____________________
ìˆ˜ì§‘ ì‹œì‘ ì‹œê°„: ____________________

[Step 1: ì£¼ê°€ ë°ì´í„°]
ìˆ˜ì§‘ëœ í‹°ì»¤: __________ ê°œ
ì €ì¥ëœ ì£¼ê°€: __________ ê°œ
ì˜¤ë¥˜ìœ¨: __________ %
ì™„ë£Œ ì‹œê°„: __________________

[Step 2: ê¸°ìˆ ì§€í‘œ]
ê³„ì‚°ëœ í‹°ì»¤: __________ ê°œ
ì €ì¥ëœ ì§€í‘œ: __________ ê°œ
ì™„ë£Œ ì‹œê°„: __________________

[Step 3: ê²€ì¦]
ì–´ì œ í‹°ì»¤ ìˆ˜: __________ ê°œ
ì˜¤ëŠ˜ í‹°ì»¤ ìˆ˜: __________ ê°œ
ë™ê¸°í™” ìƒíƒœ: â˜ ì™„ë²½ / â˜ ë¶€ë¶„ / â˜ ëˆ„ë½

[íŠ¹ì´ì‚¬í•­]
- _______________
- _______________

[ìµœì¢… ìƒíƒœ]
âœ… ìˆ˜ì§‘ ì™„ë£Œ / âŒ ìˆ˜ì§‘ ì‹¤íŒ¨ / âš ï¸ ë¶€ë¶„ ìˆ˜ì§‘
```

---

## ğŸ”— ì°¸ê³  ìë£Œ

### ê´€ë ¨ íŒŒì¼

| íŒŒì¼ëª… | ìš©ë„ |
|--------|------|
| `collect_stock_data_20251022.py` | ì£¼ê°€ + ì§€í‘œ ì¢…í•© ìˆ˜ì§‘ |
| `collect_missing_tickers_20251022.py` | ëˆ„ë½ëœ í‹°ì»¤ë§Œ ìˆ˜ì§‘ |
| `calculate_missing_indicators_20251022.py` | ëˆ„ë½ëœ ì§€í‘œë§Œ ê³„ì‚° |

### ìŠ¤í¬ë¦½íŠ¸ ë³€ìˆ˜ ì„¤ì • ê°€ì´ë“œ

ëª¨ë“  ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ë‹¤ìŒ ë³€ìˆ˜ë¥¼ ì •í™•í•˜ê²Œ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤:

```python
# Python ìŠ¤í¬ë¦½íŠ¸
from datetime import date

TARGET_DATE = date(2025, 10, 22)  # ë…„, ì›”, ì¼ ì •í™•íˆ
DATE_STR = TARGET_DATE.strftime('%Y%m%d')  # "20251022" í˜•ì‹
```

```bash
# Bash ìŠ¤í¬ë¦½íŠ¸
TARGET_DATE="2025-10-22"  # YYYY-MM-DD í˜•ì‹
DATE_STR=$(echo $TARGET_DATE | tr -d '-')  # "20251022"
```

### API ì •ë³´

**pykrx ë¼ì´ë¸ŒëŸ¬ë¦¬**:
- í•œêµ­ ì£¼ì‹ì‹œì¥ ë°ì´í„° ì œê³µ
- ì‚¬ìš© í•¨ìˆ˜:
  - `get_market_ticker_list(date)` - ê±°ë˜ì†Œ ì „ì²´ í‹°ì»¤
  - `get_market_ohlcv(from_date, to_date, ticker)` - OHLCV ë°ì´í„°

**ì§€í‘œ ê³„ì‚°**:
- RSI: ìƒëŒ€ê°•ë„ì§€ìˆ˜ (0~100)
- MACD: ì´ë™í‰ê·  ìˆ˜ë ´ì‚°ì‚° (ì¶”ì„¸ ì¶”ì¢…)
- SMA: ë‹¨ìˆœì´ë™í‰ê·  (20, 50, 200ì¼)
- Bollinger Bands: ë³€ë™ì„± ì§€í‘œ

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

1. **ë‚ ì§œëŠ” ë°˜ë“œì‹œ ì‹œìŠ¤í…œ ëª…ë ¹ì–´ë¡œ í™•ì¸**
   - Claudeì˜ ì¶”ë¡  ê¸ˆì§€
   - `Get-Date` ë˜ëŠ” `date` ëª…ë ¹ì–´ ì‚¬ìš©

2. **í…Œì´ë¸” ì»¬ëŸ¼ëª… ì •í™•íˆ í™•ì¸**
   - `sma_20` âŒ â†’ `ma_20` âœ…
   - `bb_upper` âŒ â†’ `bollinger_upper` âœ…

3. **ë³€ìˆ˜ ì„¤ì • ì¬í™•ì¸**
   - TARGET_DATE = date(2025, 10, 22)
   - DATE_STR = "20251022"

4. **ì‹¤í–‰ ì „ Docker ìƒíƒœ í™•ì¸**
   - ëª¨ë“  ì»¨í…Œì´ë„ˆê°€ Up ìƒíƒœ
   - ë°ì´í„°ë² ì´ìŠ¤ ì ‘ì† í™•ì¸

5. **ì •ìƒ ìˆ˜ì§‘ ê¸°ì¤€**
   - ì£¼ê°€: 2,700ê°œ ì´ìƒ
   - ì§€í‘œ: 2,750ê°œ ì´ìƒ
   - ì–´ì œì™€ ë™ì¼í•œ í‹°ì»¤ ìˆ˜

---

**ìµœì¢… ê²€ì¦ ì¼ì**: 2025-10-22
**ê²€ì¦ëœ ê²°ê³¼**: ì£¼ê°€ 2,761ê°œ âœ… / ì§€í‘œ 2,775ê°œ âœ…
**ë§¤ë‰´ì–¼ ë²„ì „**: v1.0
