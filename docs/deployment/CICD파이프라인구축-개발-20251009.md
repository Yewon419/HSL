# Git ì €ì¥ì†Œ ì •ë¦¬ ë° CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•

**ì‘ì—…ì¼**: 2025-10-09
**ì‘ì—… êµ¬ë¶„**: ê°œë°œ
**ê´€ë ¨ Phase**: Phase 3 (Git & CI/CD)

---

## ğŸ“‹ ì‘ì—… ê°œìš”

ë¡œì»¬ ê°œë°œ í™˜ê²½ì˜ Git ì €ì¥ì†Œë¥¼ ì •ë¦¬í•˜ê³ , GitHub Actionsë¥¼ ì‚¬ìš©í•œ ìë™ ë°°í¬ íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤.

### ì‘ì—… ëª©í‘œ
- Git ì €ì¥ì†Œ ì •ë¦¬ (ë¶ˆí•„ìš”í•œ íŒŒì¼ ì œê±°, .gitignore ì—…ë°ì´íŠ¸)
- Phase 1-2 ë³€ê²½ì‚¬í•­ ì»¤ë°‹
- GitHub ì €ì¥ì†Œ ì—°ë™ ë° Push
- CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶• (ìë™ ë°°í¬)

---

## ğŸ”§ ì‘ì—… ë‚´ìš©

### 1. Git ì €ì¥ì†Œ ì •ë¦¬

#### 1.1 .gitignore ì—…ë°ì´íŠ¸

**ë£¨íŠ¸ .gitignore (F:\hhstock\.gitignore)**
```gitignore
# í™˜ê²½ ë³€ìˆ˜ íŒŒì¼
.env
.env.development
.env.production
!.env.example
!.env.*.example

# ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…
*.sql
stocktrading_backup*.sql

# Celery
celerybeat-schedule
celerybeat-schedule.db

# ë°°í¬ íŒŒì¼
deployment/
*.tar.gz

# ì„ì‹œ íŒŒì¼
1wT/
temp_*.json

# Office íŒŒì¼
*.pptx
*.xlsx
*.docx
```

**stock-trading-system/.gitignore**
- ë™ì¼í•œ íŒ¨í„´ ì ìš©
- Docker Compose ë°±ì—… íŒŒì¼ ì¶”ê°€ (`docker-compose.yml.bak`)

#### 1.2 ì‚­ì œëœ íŒŒì¼ ì •ë¦¬

**ì •ë¦¬ëœ íŒŒì¼ (30ê°œ ì´ìƒ)**
- êµ¬ ë¬¸ì„œ íŒŒì¼ ì‚­ì œ (ë£¨íŠ¸ì˜ ê°œë³„ MD íŒŒì¼ë“¤)
- stock-trading-system/ ë‚´ë¶€ì˜ êµ¬ ë¬¸ì„œë“¤
- ì¤‘ë³µëœ ê°€ì´ë“œ ë° ë§¤ë‰´ì–¼ íŒŒì¼

**ë¬¸ì„œ ì¬êµ¬ì¡°í™”**
- `docs/architecture/`: ì•„í‚¤í…ì²˜ ë¬¸ì„œ
- `docs/development-logs/`: ê°œë°œ ë¡œê·¸
- `docs/guides/`: ê°€ì´ë“œ ë¬¸ì„œ
- `docs/planning/`: ê¸°íš ë¬¸ì„œ
- `docs/strategies/`: ì „ëµ ë¬¸ì„œ
- `docs/user-manuals/`: ì‚¬ìš©ì ë§¤ë‰´ì–¼
- `docs/work-summaries/`: ì‘ì—… ìš”ì•½

#### 1.3 ìƒˆ íŒŒì¼ ì¶”ê°€

**í™˜ê²½ ì„¤ì • í…œí”Œë¦¿**
- `stock-trading-system/.env.example`: í™˜ê²½ ë³€ìˆ˜ í…œí”Œë¦¿
- `stock-trading-system/.env.production.example`: ìš´ì˜ í™˜ê²½ í…œí”Œë¦¿

**Docker Compose ì˜¤ë²„ë¼ì´ë“œ**
- `stock-trading-system/docker-compose.dev.yml`: ê°œë°œ í™˜ê²½
- `stock-trading-system/docker-compose.prod.yml`: ìš´ì˜ í™˜ê²½

**ê¸°íƒ€**
- `datasources.yml`: Grafana ë°ì´í„°ì†ŒìŠ¤ ì„¤ì •
- `distributed_stock_pipeline.py`: Airflow DAG
- `start_hsl.md`: ì‹œìŠ¤í…œ ì‹œì‘ ê°€ì´ë“œ

### 2. ë³€ê²½ì‚¬í•­ ì»¤ë°‹

#### ì»¤ë°‹ 1: Phase 1-2 í™˜ê²½ ë¶„ë¦¬ ë° Docker Compose êµ¬ì¡° ê°œì„ 

**ì»¤ë°‹ í•´ì‹œ**: `a9fd480`

**ì£¼ìš” ë³€ê²½ì‚¬í•­**
- 184 files changed, 12067 insertions(+), 496 deletions(-)
- Pydantic Settings ê¸°ë°˜ config.py ì „í™˜
- Docker Compose Override íŒ¨í„´ ë„ì…
- í™˜ê²½ë³„ .env íŒŒì¼ ì§€ì›
- ë¬¸ì„œ êµ¬ì¡°í™” (docs/ ë””ë ‰í† ë¦¬)

**ì»¤ë°‹ ë©”ì‹œì§€**
```
feat: Phase 1-2 í™˜ê²½ ë¶„ë¦¬ ë° Docker Compose êµ¬ì¡° ê°œì„ 

## Phase 1: í™˜ê²½ ë³€ìˆ˜ ë¶„ë¦¬
- config.pyë¥¼ Pydantic Settings ê¸°ë°˜ìœ¼ë¡œ ì „í™˜
- í•˜ë“œì½”ë”©ëœ DATABASE_URL, REDIS_URL ì œê±°
- ìë™ URL ìƒì„± ê¸°ëŠ¥ ì¶”ê°€
- í™˜ê²½ë³„ .env íŒŒì¼ ì§€ì› (development/production)

## Phase 2: Docker Compose Override íŒ¨í„´
- docker-compose.yml: ë² ì´ìŠ¤ ì„¤ì •
- docker-compose.dev.yml: ê°œë°œ í™˜ê²½ ì˜¤ë²„ë¼ì´ë“œ
- docker-compose.prod.yml: ìš´ì˜ í™˜ê²½ ì˜¤ë²„ë¼ì´ë“œ
- í™˜ê²½ë³„ ì„œë¹„ìŠ¤ ë¶„ë¦¬ (DB, Backend, Scheduler)

## ë¬¸ì„œ ì •ë¦¬
- docs/ ë””ë ‰í† ë¦¬ êµ¬ì¡°í™”
- ë¶ˆí•„ìš”í•œ êµ¬ ë¬¸ì„œ ì œê±°
- Claude Code Expert Guide ì¶”ê°€
- 3ì„œë²„ ë¶„ì‚° ë°°í¬ ë° DB ë§ˆì´ê·¸ë ˆì´ì…˜ ë¬¸ì„œ ì¶”ê°€

ğŸ¤– Generated with Claude Code
Co-Authored-By: Claude <noreply@anthropic.com>
```

#### ì»¤ë°‹ 2: GitHub Actions CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•

**ì»¤ë°‹ í•´ì‹œ**: `ee09969`

**ì£¼ìš” ë³€ê²½ì‚¬í•­**
- 2 files changed, 313 insertions(+)
- `.github/workflows/deploy.yml`: ë°°í¬ ì›Œí¬í”Œë¡œìš°
- `.github/workflows/README.md`: CI/CD ì„¤ì • ê°€ì´ë“œ

**ì»¤ë°‹ ë©”ì‹œì§€**
```
feat: GitHub Actions CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•

## ê¸°ëŠ¥
- main ë¸Œëœì¹˜ Push ì‹œ ìë™ ë°°í¬
- 102 ì„œë²„ (Backend/Celery) ë°°í¬
- 101 ì„œë²„ (Scheduler/Grafana) ë°°í¬
- Health Check ìë™í™”
- ìˆ˜ë™ ë°°í¬ ì§€ì› (workflow_dispatch)

## ë°°í¬ ìˆœì„œ
1. 102 ì„œë²„ ë°°í¬ â†’ ì„±ê³µ ì‹œ
2. 101 ì„œë²„ ë°°í¬ â†’ ì„±ê³µ ì‹œ
3. Health Check ì‹¤í–‰

ğŸ¤– Generated with Claude Code
Co-Authored-By: Claude <noreply@anthropic.com>
```

### 3. GitHub Push

**ì›ê²© ì €ì¥ì†Œ**: `https://github.com/chohkcloud/happystocklife.git`

**Push ê²°ê³¼**
```
To https://github.com/chohkcloud/happystocklife.git
   9799f87..a9fd480  main -> main  (Phase 1-2)
   a9fd480..ee09969  main -> main  (CI/CD)
```

### 4. CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•

#### 4.1 GitHub Actions ì›Œí¬í”Œë¡œìš°

**íŒŒì¼**: `.github/workflows/deploy.yml`

**ë°°í¬ íë¦„**
```
ë¡œì»¬ ê°œë°œ â†’ Git Push â†’ GitHub
    â†“
GitHub Actions íŠ¸ë¦¬ê±°
    â†“
[Job 1] 102 ì„œë²„ ë°°í¬ (Backend/Celery)
    â†“ ì„±ê³µ ì‹œ
[Job 2] 101 ì„œë²„ ë°°í¬ (Scheduler/Grafana)
    â†“ ì„±ê³µ ì‹œ
[Job 3] Health Check
    â†“
ë°°í¬ ì™„ë£Œ âœ…
```

**Job 1: deploy-102-backend**
- SSHë¡œ 102 ì„œë²„ ì ‘ì†
- Git Pull (ìµœì‹  ì½”ë“œ)
- Docker Compose ì¤‘ì§€
- ìš´ì˜ í™˜ê²½ ì¬ë¹Œë“œ ë° ì¬ì‹œì‘
- ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸

**Job 2: deploy-101-scheduler**
- SSHë¡œ 101 ì„œë²„ ì ‘ì†
- Git Pull (ìµœì‹  ì½”ë“œ)
- Docker Compose ì¤‘ì§€
- ìš´ì˜ í™˜ê²½ ì¬ë¹Œë“œ ë° ì¬ì‹œì‘
- ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸

**Job 3: health-check**
- Backend API Health Check: `http://192.168.219.102:8000/health`
- Grafana Health Check: `http://192.168.219.101:3000/api/health`
- ë°°í¬ ì„±ê³µ ë©”ì‹œì§€ ì¶œë ¥

#### 4.2 í•„ìˆ˜ ì„¤ì •

**GitHub Secrets**
- `SSH_PRIVATE_KEY`: ì„œë²„ SSH ì ‘ì†ìš© Private Key

**ì„œë²„ ì‚¬ì „ ì‘ì—…**
1. Git ì €ì¥ì†Œ Clone
   ```bash
   cd ~
   git clone https://github.com/chohkcloud/happystocklife.git stock-trading-system
   ```

2. .env.production íŒŒì¼ ìƒì„±
   ```bash
   cd stock-trading-system
   cp stock-trading-system/.env.production.example stock-trading-system/.env.production
   # ì‹¤ì œ ê°’ìœ¼ë¡œ ìˆ˜ì •
   ```

3. SSH Public Key ë“±ë¡
   ```bash
   # ë¡œì»¬ì—ì„œ
   ssh-copy-id hansol@192.168.219.102
   ssh-copy-id hansol@192.168.219.101
   ```

---

## ğŸ“Š ì‘ì—… ê²°ê³¼

### Git ì €ì¥ì†Œ í˜„í™©

**ì»¤ë°‹ ì´ë ¥**
```
ee09969 feat: GitHub Actions CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•
a9fd480 feat: Phase 1-2 í™˜ê²½ ë¶„ë¦¬ ë° Docker Compose êµ¬ì¡° ê°œì„ 
9799f87 docs: ìŠ¤í¬ë¦¬ë‹ UI ê°œì„  ì‘ì—… ë¬¸ì„œí™”
a06cee8 feat: ìŠ¤í¬ë¦¬ë‹ íƒ­ UI ê°œì„  ë° ë§¤ë§¤ì‹ í˜¸ ì—°ë™ ê¸°ëŠ¥ ì¶”ê°€
```

**íŒŒì¼ í†µê³„**
- Phase 1-2 ì»¤ë°‹: 184 files, +12067/-496 lines
- CI/CD ì»¤ë°‹: 2 files, +313 lines
- ì´ ë³€ê²½: 186 files, +12380/-496 lines

**ë¬¸ì„œ êµ¬ì¡°**
```
docs/
â”œâ”€â”€ architecture/          # ì•„í‚¤í…ì²˜ ë¬¸ì„œ (3ê°œ)
â”œâ”€â”€ deployment/           # ë°°í¬ ê´€ë ¨ ë¬¸ì„œ (2ê°œ)
â”œâ”€â”€ development-logs/     # ê°œë°œ ë¡œê·¸ (10ê°œ)
â”œâ”€â”€ guides/              # ê°€ì´ë“œ (120ê°œ+)
â”‚   â””â”€â”€ claude-code-expert-guide/  # Claude Code ê°€ì´ë“œ (111ê°œ)
â”œâ”€â”€ planning/            # ê¸°íš ë¬¸ì„œ (5ê°œ)
â”œâ”€â”€ strategies/          # ì „ëµ ë¬¸ì„œ (3ê°œ)
â”œâ”€â”€ user-manuals/        # ì‚¬ìš©ì ë§¤ë‰´ì–¼ (10ê°œ)
â””â”€â”€ work-summaries/      # ì‘ì—… ìš”ì•½ (4ê°œ)
```

### CI/CD íŒŒì´í”„ë¼ì¸ í˜„í™©

**ë°°í¬ íŠ¸ë¦¬ê±°**
- Push to `main` ë¸Œëœì¹˜ â†’ ìë™ ë°°í¬
- Manual trigger (workflow_dispatch) â†’ ìˆ˜ë™ ë°°í¬

**ë°°í¬ ëŒ€ìƒ**
- 102 ì„œë²„: Backend, Celery Worker, Celery Beat
- 101 ì„œë²„: Grafana, Airflow Webserver, Airflow Scheduler

**Health Check ì—”ë“œí¬ì¸íŠ¸**
- Backend: `http://192.168.219.102:8000/health`
- Grafana: `http://192.168.219.101:3000/api/health`

---

## ğŸ¯ ë‹¬ì„± ëª©í‘œ

### Phase 3 ëª©í‘œ ë‹¬ì„± âœ…

- [x] Git ì €ì¥ì†Œ ì •ë¦¬
  - [x] .gitignore ì—…ë°ì´íŠ¸
  - [x] ë¶ˆí•„ìš”í•œ íŒŒì¼ ì œê±°
  - [x] ë¬¸ì„œ ì¬êµ¬ì¡°í™”

- [x] ë³€ê²½ì‚¬í•­ ì»¤ë°‹
  - [x] Phase 1-2 ë³€ê²½ì‚¬í•­ ì»¤ë°‹
  - [x] ì˜ë¯¸ ìˆëŠ” ì»¤ë°‹ ë©”ì‹œì§€ ì‘ì„±
  - [x] Co-Authored-By ì¶”ê°€

- [x] GitHub ì—°ë™
  - [x] ê¸°ì¡´ ì €ì¥ì†Œ í™•ì¸
  - [x] Push ì„±ê³µ

- [x] CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•
  - [x] GitHub Actions ì›Œí¬í”Œë¡œìš° ì‘ì„±
  - [x] ìë™ ë°°í¬ ì„¤ì •
  - [x] Health Check ìë™í™”
  - [x] ì„¤ì • ê°€ì´ë“œ ë¬¸ì„œí™”

---

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„

### Phase 4: ì‹¤ì œ ì„œë²„ ë°°í¬ í…ŒìŠ¤íŠ¸

**ì¤€ë¹„ ì‘ì—…**
1. GitHub Secrets ì„¤ì •
   - SSH_PRIVATE_KEY ë“±ë¡

2. ì„œë²„ ì‚¬ì „ ì‘ì—…
   - Git ì €ì¥ì†Œ Clone
   - .env.production íŒŒì¼ ìƒì„±
   - SSH Key ë“±ë¡

3. ì²« ë²ˆì§¸ ìë™ ë°°í¬ í…ŒìŠ¤íŠ¸
   - ê°„ë‹¨í•œ ë³€ê²½ì‚¬í•­ Push
   - GitHub Actions ë¡œê·¸ í™•ì¸
   - ì„œë²„ ë°°í¬ ê²°ê³¼ í™•ì¸

**ì¶”ê°€ ê°œì„  ì‚¬í•­**
- [ ] Staging í™˜ê²½ êµ¬ì¶•
- [ ] ë¡¤ë°± ìë™í™”
- [ ] Slack/Discord ì•Œë¦¼ ì—°ë™
- [ ] ë°°í¬ ì „ í…ŒìŠ¤íŠ¸ ìë™í™” (Unit Test, Integration Test)
- [ ] Blue-Green ë°°í¬ ì „ëµ ê²€í† 

---

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

- [Phase 1-2: CI/CD í™˜ê²½ ë¶„ë¦¬ ì „ëµ](./CICDí™˜ê²½ë¶„ë¦¬ì „ëµ-ê°€ì´ë“œ-20251009.md)
- [3ì„œë²„ Docker ë¶„ì‚° ë°°í¬](../development-logs/3ì„œë²„Dockerë¶„ì‚°ë°°í¬-ê°œë°œ-20251008.md)
- [3ì„œë²„ ë¶„ì‚° ë°°í¬ DB ë§ˆì´ê·¸ë ˆì´ì…˜](../development-logs/3ì„œë²„ë¶„ì‚°ë°°í¬DBë§ˆì´ê·¸ë ˆì´ì…˜-ê°œë°œ-20251009.md)
- [GitHub Actions CI/CD ê°€ì´ë“œ](../../.github/workflows/README.md)
- [ì„œë²„ ë°°í¬ ê°€ì´ë“œ](../../deployment/README.md)

---

## ğŸ” ì°¸ê³  ì‚¬í•­

### Git ì›Œí¬í”Œë¡œìš°

**ê°œë°œ íë¦„**
```
1. ë¡œì»¬ì—ì„œ ê°œë°œ
2. git add . && git commit -m "message"
3. git push origin main
4. GitHub Actions ìë™ ë°°í¬
5. ì„œë²„ Health Check
```

**ë¡¤ë°± ë°©ë²•**
```bash
# ì„œë²„ì—ì„œ ì‹¤í–‰
cd /home/hansol/stock-trading-system
git log --oneline -5
git checkout <ì´ì „-ì»¤ë°‹-í•´ì‹œ>
docker-compose down
ENVIRONMENT=production docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d
```

### ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

1. **í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬**
   - .env íŒŒì¼ì€ Gitì— ì»¤ë°‹í•˜ì§€ ì•ŠìŒ
   - ê° ì„œë²„ì—ì„œ ì§ì ‘ ê´€ë¦¬
   - í…œí”Œë¦¿ íŒŒì¼ë§Œ Git ì¶”ì  (.env.example)

2. **SSH Key ê´€ë¦¬**
   - Private KeyëŠ” GitHub Secretsì—ë§Œ ì €ì¥
   - ì ˆëŒ€ ì½”ë“œì— í¬í•¨í•˜ì§€ ì•ŠìŒ

3. **ë„¤íŠ¸ì›Œí¬ ì ‘ê·¼**
   - GitHub Actions RunnerëŠ” SSHë¡œë§Œ ì„œë²„ ì ‘ê·¼
   - ë°©í™”ë²½ ì„¤ì •: 22ë²ˆ í¬íŠ¸ í—ˆìš©

---

**ì‘ì„±ì¼**: 2025-10-09
**ì‘ì„±ì**: HSL Trading System + Claude Code
**ë¬¸ì„œ ë²„ì „**: 1.0
