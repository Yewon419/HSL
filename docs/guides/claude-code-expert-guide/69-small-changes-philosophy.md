# Incremental Development #69: 작은 변경 철학

## 원칙

**Plan → Small Diff → Tests → Review**

이 워크플로우를 종교적으로 따르세요. 압박을 받더라도 단계를 건너뛰지 마세요.

## 이유

큰 변경은:
- 리뷰하기 어려움
- 버그 찾기 어려움
- 롤백 시 많은 작업 손실
- 충돌 가능성 높음
- 디버깅 어려움

작은 변경은:
- 빠른 리뷰
- 쉬운 검증
- 안전한 롤백
- 명확한 원인 파악
- 지속적 진행 가능

## The Golden Workflow

```
┌─────────────────────────────────────┐
│  1. PLAN                            │
│  - 전체 그림 이해                    │
│  - 단계별 분해                       │
│  - 각 단계 검증 방법 정의            │
└──────────┬──────────────────────────┘
           ↓
┌──────────┴──────────────────────────┐
│  2. SMALL DIFF                       │
│  - 200 lines 이하                    │
│  - 하나의 목적                       │
│  - 독립적으로 완성                   │
└──────────┬──────────────────────────┘
           ↓
┌──────────┴──────────────────────────┐
│  3. TESTS                            │
│  - 단위 테스트                       │
│  - 통합 테스트                       │
│  - Edge cases                        │
└──────────┬──────────────────────────┘
           ↓
┌──────────┴──────────────────────────┐
│  4. REVIEW                           │
│  - 코드 리뷰                         │
│  - 테스트 확인                       │
│  - 문서 업데이트                     │
└──────────┬──────────────────────────┘
           ↓
┌──────────┴──────────────────────────┐
│  5. COMMIT                           │
│  - 의미 있는 커밋 메시지             │
│  - 원자적 커밋                       │
└──────────┬──────────────────────────┘
           ↓
         다음 단계로 반복
```

## 실전 예시

### ❌ 잘못된 방법: 한 번에 모든 것

```
사용자: "전자상거래 사이트를 만들어줘"

Claude: [3000 lines의 코드를 한 번에 생성]
→ 버그 많음
→ 어디서 문제인지 모름
→ 테스트 어려움
→ 리뷰 불가능
```

### ✅ 올바른 방법: 단계적 접근

```
사용자: "전자상거래 사이트를 만들려고 해. 10단계로 나눠서 계획을 세워줘"

Claude:
## 계획
1. [~50 lines] 데이터 모델 설계
2. [~80 lines] 사용자 인증
3. [~100 lines] 제품 목록 API
4. [~120 lines] 장바구니 기능
5. [~90 lines] 주문 처리
6. [~70 lines] 결제 통합
7. [~80 lines] 프론트엔드 레이아웃
8. [~150 lines] 제품 페이지
9. [~130 lines] 체크아웃 플로우
10. [~60 lines] 주문 관리

사용자: "Step 1만 구현해줘"

Claude:
# Step 1: 데이터 모델 설계 (50 lines)

[모델 코드]

# Tests (30 lines)
[테스트 코드]

# 실행
pytest tests/test_models.py
→ All tests passed ✓

사용자: [리뷰 후] "좋아, 커밋하고 Step 2 진행"
```

## 작은 Diff의 기준

### 권장 크기
- **~50 lines**: 이상적
- **50-200 lines**: 적절
- **200+ lines**: 너무 큼, 나눠야 함

### 한 Diff = 한 목적

```
✅ 좋은 예:
- "Add email validation to User model"
- "Create login API endpoint"
- "Add unit tests for auth service"

❌ 나쁜 예:
- "Add authentication, update UI, fix bugs"
  → 3개의 별도 diff로 나눠야 함
```

## 실전 팁

### 1. 타임박스 사용

```
사용자: "이 작업을 30분 안에 완료할 수 있는 크기로 나눠줘"
```

### 2. 독립적 배포 가능

각 단계가 배포 가능해야 함:

```
Step 1: [배포 가능] ✓
Step 2: [배포 가능] ✓
Step 3: [배포 가능] ✓
```

### 3. Checkpoint 활용

```
각 단계 전: checkpoint
각 단계 후: commit
문제 발생: rewind to checkpoint
성공: 다음 단계
```

## 압박받을 때

### 시나리오: "내일까지 끝내야 해요!"

❌ 나쁜 대응:
```
"단계 건너뛰고 빨리 만들게"
→ 버그 많음
→ 내일 더 많은 시간 필요
```

✅ 좋은 대응:
```
"더 빨리 가려면 더 작은 단계로:

1. 핵심 기능만 (1시간)
2. 테스트 (30분)
3. 배포 (10분)
4. 나머지 기능 우선순위화

안정적으로 내일까지 MVP 완성 가능"
```

## 컨텍스트 관리

### 단계 완료 시 /clear

```
Step 1 완료 → /clear
Step 2 시작 → @docs/plan.md 참조
```

이유:
- 토큰 절약
- 컨텍스트 집중
- 각 단계 독립적

## 측정 가능한 진행

```
Plan:
[✓] Step 1: Models (1h)
[✓] Step 2: Auth (1.5h)
[→] Step 3: API (진행중, 0.5h/1h)
[ ] Step 4: Frontend (2h)
[ ] Step 5: Deploy (0.5h)

진행률: 40% (2.5/6h)
```

## 리듬 유지

```
50분 작업 → 10분 리뷰 → 커밋
50분 작업 → 10분 리뷰 → 커밋
...

하루 = 4-6 사이클
1주일 = 20-30 커밋
```

## 경고 신호

다음 신호가 나타나면 **더 작게** 나눠야 함:

- [ ] 30분 넘게 리뷰 중
- [ ] 무엇이 변경되었는지 설명 어려움
- [ ] 여러 파일이 복잡하게 얽힘
- [ ] 테스트 작성이 막막함
- [ ] 롤백이 두려움

## 인용구

> "The only way to go fast is to go well."
> - Robert C. Martin

> "Make it work, make it right, make it fast."
> - Kent Beck

## 관련 항목

- [22-keep-diffs-small.md](22-keep-diffs-small.md) - 작은 diff 유지
- [70-keep-context-tight.md](70-keep-context-tight.md) - 컨텍스트 관리
- [73-checkpoints-and-rewind.md](73-checkpoints-and-rewind.md) - 체크포인트 활용
